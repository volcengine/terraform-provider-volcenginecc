---
page_title: "volcenginecc_waf_domain Resource - terraform-provider-volcenginecc"
subcategory: ""
description: |-
  通过 CNAME 或是负载均衡方式接入防护网站，并配置接入能力和回源能力，将业务流量接入到 WAF 实例，实现防护。
---

# volcenginecc_waf_domain (Resource)

通过 CNAME 或是负载均衡方式接入防护网站，并配置接入能力和回源能力，将业务流量接入到 WAF 实例，实现防护。

## Example Usage

```terraform
resource "volcenginecc_waf_domain" "WafDomainDemo" {
  access_mode        = 10
  domain             = "www.test.com"
  lb_algorithm       = "wrr"
  public_real_server = 1
  vpc_id             = ""
  protocol_ports = {
    http = [80]
  }
  protocols = ["HTTP"]
  backend_groups = [
    {
      access_port = [80]
      backends = [
        {
          protocol = "HTTP"
          port     = 80
          ip       = "1.1.1.1"
          weight   = 50
        }
      ]
      name = "default"
    }
  ]
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `access_mode` (Number) 接入模式。10：CNAME 接入，11：负载均衡（CLB）7 层接入。
- `domain` (String) 防护的域名信息，支持泛域名和精确域名。

### Optional

- `api_enable` (Number) 是否开启了 API 防护策略。0：关闭，1：开启。
- `auto_cc_enable` (Number) 是否开启智能 CC 防护策略。0：关闭，1：开启。
- `backend_groups` (Attributes List) 源站配置。
 特别提示: 在使用 ListNestedAttribute 或 SetNestedAttribute 时，必须完整定义其嵌套结构体的所有属性。若定义不完整，Terraform 在执行计划对比时可能会检测到意料之外的差异，从而触发不必要的资源更新，影响资源的稳定性与可预测性。 (see [below for nested schema](#nestedatt--backend_groups))
- `black_ip_enable` (Number) 是否开启了黑名单策略。0：关闭, 1：开启。
- `black_lct_enable` (Number) 是否开启了区域封禁策略。0：关闭;1：开启。
- `bot_dytoken_enable` (Number) 是否开启动态Token防护。
- `bot_frequency_enable` (Number) 是否开启 bot 频率限制策略。
0：关闭
1：开启。
- `bot_repeat_enable` (Number) 是否开启 bot 统计防护策略。
0：关闭
1：开启。
- `bot_sequence_default_action` (Number) 设置 bot 行为地图策略默认动作，当 BotSequenceEnable = 1 开启状态时生效。默认为 0 （观察）。
0：观察
2：拦截
6：JS 挑战
7：人机验证。
- `bot_sequence_enable` (Number) 是否开启 bot 行为地图。
0：关闭
1：开启。
- `cc_enable` (Number) 是否开启 CC 防护策略。
0：关闭
1：开启。
- `certificate_id` (String) 托管至证书中心的证书ID。
- `certificate_platform` (String) 证书托管平台:waf/certificate_service。
- `client_ip_location` (Number) 客户端IP获取方式。0:自定义Header字段,1:通过X-Forwarded-For(XFF)字段中第一个公网IP地址作为客户端真实IP地址。
- `client_max_body_size` (Number) 客户端请求body最大值(MB)。
- `cloud_access_config` (Attributes Set) LB接入参数。
 特别提示: 在使用 ListNestedAttribute 或 SetNestedAttribute 时，必须完整定义其嵌套结构体的所有属性。若定义不完整，Terraform 在执行计划对比时可能会检测到意料之外的差异，从而触发不必要的资源更新，影响资源的稳定性与可预测性。 (see [below for nested schema](#nestedatt--cloud_access_config))
- `custom_bot_enable` (Number) 是否开启自定义BOT防护。
- `custom_header` (Set of String) 自定义Header。
- `custom_rsp_enable` (Number) 是否开启自定义响应。
- `custom_sni` (String) 自定义SNI。
- `defence_mode` (Number) 为例外 ALB 实例设置防护模式。
1：启用防护，已配置的防护策略生效。
2：暂停防护，仅执行转发而不检测，已配置的防护策略不生效。
3：回源模式，直接将请求解析至源站，不再转发至 WAF 实例。
设置例外防护实例后，域名可能还会存在以下防护状态：
5：部分启用，默认防护模式为启用防护，但存在例外实例为暂停防护或回源模式状态。
6：部分暂停，默认防护模式为暂停防护，但存在例外实例为启用防护或回源模式状态。
7：部分回源，默认防护模式为回源模式，但存在例外实例为启用防护或暂停防护状态。
- `dlp_enable` (Number) 是否开启数据泄露防护。
- `enable_custom_redirect` (Number) 是否开启用户自定义重定向。0:关闭,1:开启。
- `enable_http2` (Number) 是否开启HTTP2.0。0:关闭,1:开启。
- `enable_ipv_6` (Number) 是否支持防护Ipv6请求。0:关闭,1:开启。
- `enable_sni` (Number) 是否开启SNI配置。0:关闭,1:开启。
- `keep_alive_request` (Number) 长连接复用个数。
- `keep_alive_timeout` (Number) 长连接保持时间(秒)。
- `lb_algorithm` (String) 负载均衡算法类型。wrr:加权轮询,wlc:加权最小连接数,sh:源地址哈希。
- `project_name` (String) 项目名称。
- `protocol_follow` (Number) 是否开启协议跟随。0:关闭,1:开启。
- `protocol_ports` (Attributes) 接入端口信息。 (see [below for nested schema](#nestedatt--protocol_ports))
- `protocols` (Set of String) 接入协议类型,支持HTTP/HTTPS。
- `proxy_config` (Number) 是否开启代理配置。0:关闭,1:开启。
- `proxy_connect_timeout` (Number) WAF和后端服务器的建连超时时间(秒)。
- `proxy_keep_alive` (Number) WAF回源长连接可复用个数。
- `proxy_keep_alive_timeout` (Number) 空闲长连接超时时间(秒)。
- `proxy_read_timeout` (Number) WAF从后端服务器读取响应的超时时间(秒)。
- `proxy_retry` (Number) WAF回源重试次数。
- `proxy_write_timeout` (Number) WAF将请求传输到后端服务器的超时时间(秒)。
- `public_real_server` (Number) CNAME接入回源方式。0:私网回源,1:公网回源。
- `ssl_ciphers` (Set of String) 加密套件。
- `ssl_protocols` (Set of String) TLS协议版本。如:TLSv1,TLSv1.1,TLSv1.2,TLSv1.3。
- `system_bot_enable` (Number) 是否开启托管BOT防护。
- `tamper_proof_enable` (Number) 是否开启防篡改。
- `tls_enable` (Number) 是否开启日志服务。0:关闭,1:开启。
- `tls_fields_config` (Attributes) 日志字段配置详情。 (see [below for nested schema](#nestedatt--tls_fields_config))
- `vpc_id` (String) VPC ID。
- `waf_enable` (Number) 是否开启WAF防护。
- `waf_white_req_enable` (Number) 是否开启白名单请求防护。
- `white_enable` (Number) 是否开启白名单防护。
- `white_field_enable` (Number) 是否开启字段白名单防护。

### Read-Only

- `advanced_defense_ip` (String) 高防实例 IP。高防型 WAF 接入展示，否则为空。
- `advanced_defense_ipv_6` (String) 高防实例 Ipv6。高防型 WAF 接入展示，否则为空。
- `attack_status` (Number) 攻击状态。0:未发现攻击,1:发现攻击。
- `automatic_black_enable` (Number) 是否开启自动封禁。0：关闭，1：开启。
- `certificate_name` (String) 证书名称，协议类型包含 HTTPS 时显示。
- `clb_instance_ids` (String) CLB实例ID。
- `clb_listener_id` (String) CLB监听器ID。
- `clb_pool_id` (String) CLB后端服务器组ID。
- `clb_server_id` (String) CLB后端服务器ID。
- `cname` (String) CNAME记录。
- `id` (String) Uniquely identifies the resource.
- `port` (Number) 端口号。
- `rsp_abnormal_enable` (Number) 是否开启异常响应防护。
- `server_ips` (String) 服务IP。
- `src_ips` (String) WAF回源IP。
- `src_protocol` (String) 源站协议。
- `status` (Number) 接入状态。0:正常,1:DNS未解析,2:配置中,3:配置失败,4:配置未生效,5:更新中,6:实例已删除。
- `tcp_listener_config` (Attributes Set) TCP监听器配置。
 特别提示: 在使用 ListNestedAttribute 或 SetNestedAttribute 时，必须完整定义其嵌套结构体的所有属性。若定义不完整，Terraform 在执行计划对比时可能会检测到意料之外的差异，从而触发不必要的资源更新，影响资源的稳定性与可预测性。 (see [below for nested schema](#nestedatt--tcp_listener_config))
- `update_time` (String) 更新时间。

<a id="nestedatt--backend_groups"></a>
### Nested Schema for `backend_groups`

Optional:

- `access_port` (Set of Number) 接入的端口号。
- `backends` (Attributes Set) 源站组详情。
 特别提示: 在使用 ListNestedAttribute 或 SetNestedAttribute 时，必须完整定义其嵌套结构体的所有属性。若定义不完整，Terraform 在执行计划对比时可能会检测到意料之外的差异，从而触发不必要的资源更新，影响资源的稳定性与可预测性。 (see [below for nested schema](#nestedatt--backend_groups--backends))
- `name` (String) 源站组名称。

<a id="nestedatt--backend_groups--backends"></a>
### Nested Schema for `backend_groups.backends`

Optional:

- `ip` (String) 源站 IP 地址。
- `port` (Number) 源站端口。
- `protocol` (String) 源站协议。
- `weight` (Number) 源站权重。



<a id="nestedatt--cloud_access_config"></a>
### Nested Schema for `cloud_access_config`

Optional:

- `access_protocol` (String) 接入协议类型。
- `defence_mode` (Number) 防护模式。
- `instance_id` (String) 负载均衡实例 ID。
- `instance_name` (String) 负载均衡实例名称。
- `listener_id` (String) 负载均衡监听器 ID。
- `lost_association_from_alb` (Number)
- `port` (String) 监听器转发规则的端口号。
- `protocol` (String) 监听器转发规则的协议类型。


<a id="nestedatt--protocol_ports"></a>
### Nested Schema for `protocol_ports`

Optional:

- `http` (Set of Number) HTTP 协议的端口号。
- `https` (Set of Number) HTTPS 协议的端口号。


<a id="nestedatt--tls_fields_config"></a>
### Nested Schema for `tls_fields_config`

Optional:

- `headers_config` (Attributes) (see [below for nested schema](#nestedatt--tls_fields_config--headers_config))

<a id="nestedatt--tls_fields_config--headers_config"></a>
### Nested Schema for `tls_fields_config.headers_config`

Optional:

- `enable` (Number) 是否记录全量 header。

关闭，仅记录常见 header 字段。
启用，记录全量 header 字段，可配置例外 header 字段和统计 header 字段。
- `excluded_key_list` (Set of String) 例外 header 字段，将对应字段从字段的 JSON 中排除，可帮助节约日志存储空间。
- `statistical_key_list` (Set of String) 统计 header 字段，将对应字段用于日志统计分析和告警。



<a id="nestedatt--tcp_listener_config"></a>
### Nested Schema for `tcp_listener_config`

Read-Only:

- `access_protocol` (String)
- `defence_mode` (Number)
- `instance_id` (String)
- `instance_name` (String)
- `listener_id` (String)
- `lost_association_from_alb` (Number)
- `port` (String)
- `protocol` (String)

## Import

Import is supported using the following syntax:

```shell
$ terraform import volcenginecc_waf_domain.example "domain"
```