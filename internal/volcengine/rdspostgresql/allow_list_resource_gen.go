// Copyright (c) HashiCorp, Inc.
// SPDX-License-Identifier: MPL-2.0

// Code generated by generators/resource/main.go; DO NOT EDIT.

package rdspostgresql

import (
	"context"

	"github.com/hashicorp/terraform-plugin-framework/resource"
	"github.com/hashicorp/terraform-plugin-framework/resource/schema"
	"github.com/hashicorp/terraform-plugin-framework/resource/schema/boolplanmodifier"
	"github.com/hashicorp/terraform-plugin-framework/resource/schema/int64planmodifier"
	"github.com/hashicorp/terraform-plugin-framework/resource/schema/planmodifier"
	"github.com/hashicorp/terraform-plugin-framework/resource/schema/setplanmodifier"
	"github.com/hashicorp/terraform-plugin-framework/resource/schema/stringplanmodifier"
	"github.com/hashicorp/terraform-plugin-framework/types"
	"github.com/volcengine/terraform-provider-volcenginecc/internal/generic"
	"github.com/volcengine/terraform-provider-volcenginecc/internal/registry"
)

func init() {
	registry.AddResourceFactory("volcenginecc_rdspostgresql_allow_list", allowListResource)
}

// allowListResource returns the Terraform volcenginecc_rdspostgresql_allow_list resource.
// This Terraform resource corresponds to the Cloud Control Volcengine::RDSPostgreSQL::AllowList resource.
func allowListResource(ctx context.Context) (resource.Resource, error) {
	attributes := map[string]schema.Attribute{ /*START SCHEMA*/
		// Property: AllowList
		// Cloud Control resource type schema:
		//
		//	{
		//	  "description": "白名单中包含的 IP 地址。支持以下两种格式：IP 地址格式。例如：10.23.12.24。CIDR 的 IP 地址段格式。例如：10.23.12.0/24（无类别域间路由，24 表示了地址中前缀的长度，范围为 1~32）。说明每个白名单最多可添加 300 个 IP 或 IP 地址段，当 IP 较多时，建议合并为 IP 段填入，例如10.23.12.0/24。禁止将 0.0.0.0/0 之外的形如 x.x.x.x/0 结尾的 IP 地址加入白名单。该字段不能与 UserAllowList 字段同时使用。",
		//	  "insertionOrder": false,
		//	  "items": {
		//	    "type": "string"
		//	  },
		//	  "type": "array",
		//	  "uniqueItems": true
		//	}
		"allow_list": schema.SetAttribute{ /*START ATTRIBUTE*/
			ElementType: types.StringType,
			Description: "白名单中包含的 IP 地址。支持以下两种格式：IP 地址格式。例如：10.23.12.24。CIDR 的 IP 地址段格式。例如：10.23.12.0/24（无类别域间路由，24 表示了地址中前缀的长度，范围为 1~32）。说明每个白名单最多可添加 300 个 IP 或 IP 地址段，当 IP 较多时，建议合并为 IP 段填入，例如10.23.12.0/24。禁止将 0.0.0.0/0 之外的形如 x.x.x.x/0 结尾的 IP 地址加入白名单。该字段不能与 UserAllowList 字段同时使用。",
			Optional:    true,
			Computed:    true,
			PlanModifiers: []planmodifier.Set{ /*START PLAN MODIFIERS*/
				setplanmodifier.UseStateForUnknown(),
			}, /*END PLAN MODIFIERS*/
		}, /*END ATTRIBUTE*/
		// Property: AllowListCategory
		// Cloud Control resource type schema:
		//
		//	{
		//	  "description": "白名单分类。取值：Ordinary：普通白名单。Default：默认白名单。说明该参数作为请求参数时无默认值，不传入时则查询所有类别的白名单。",
		//	  "type": "string"
		//	}
		"allow_list_category": schema.StringAttribute{ /*START ATTRIBUTE*/
			Description: "白名单分类。取值：Ordinary：普通白名单。Default：默认白名单。说明该参数作为请求参数时无默认值，不传入时则查询所有类别的白名单。",
			Optional:    true,
			Computed:    true,
			PlanModifiers: []planmodifier.String{ /*START PLAN MODIFIERS*/
				stringplanmodifier.UseStateForUnknown(),
			}, /*END PLAN MODIFIERS*/
		}, /*END ATTRIBUTE*/
		// Property: AllowListDesc
		// Cloud Control resource type schema:
		//
		//	{
		//	  "description": "白名单的描述信息。长度在 200 字符以内。默认值为空字符串。",
		//	  "type": "string"
		//	}
		"allow_list_desc": schema.StringAttribute{ /*START ATTRIBUTE*/
			Description: "白名单的描述信息。长度在 200 字符以内。默认值为空字符串。",
			Optional:    true,
			Computed:    true,
			PlanModifiers: []planmodifier.String{ /*START PLAN MODIFIERS*/
				stringplanmodifier.UseStateForUnknown(),
			}, /*END PLAN MODIFIERS*/
		}, /*END ATTRIBUTE*/
		// Property: AllowListIPNum
		// Cloud Control resource type schema:
		//
		//	{
		//	  "description": "白名单中 IP 地址或 IP 地址段的数量。",
		//	  "format": "int32",
		//	  "type": "integer"
		//	}
		"allow_list_ip_num": schema.Int64Attribute{ /*START ATTRIBUTE*/
			Description: "白名单中 IP 地址或 IP 地址段的数量。",
			Computed:    true,
			PlanModifiers: []planmodifier.Int64{ /*START PLAN MODIFIERS*/
				int64planmodifier.UseStateForUnknown(),
			}, /*END PLAN MODIFIERS*/
		}, /*END ATTRIBUTE*/
		// Property: AllowListId
		// Cloud Control resource type schema:
		//
		//	{
		//	  "description": "白名单 ID。",
		//	  "type": "string"
		//	}
		"allow_list_id": schema.StringAttribute{ /*START ATTRIBUTE*/
			Description: "白名单 ID。",
			Computed:    true,
			PlanModifiers: []planmodifier.String{ /*START PLAN MODIFIERS*/
				stringplanmodifier.UseStateForUnknown(),
			}, /*END PLAN MODIFIERS*/
		}, /*END ATTRIBUTE*/
		// Property: AllowListName
		// Cloud Control resource type schema:
		//
		//	{
		//	  "description": "白名单名称的命名规则如下：在当前地域内，白名单名称唯一。以中文、字母或下划线（_）开头。只能包含中文、字母、数字、下划线（_）和中划线（-）。长度为 1~128 个字符。",
		//	  "type": "string"
		//	}
		"allow_list_name": schema.StringAttribute{ /*START ATTRIBUTE*/
			Description: "白名单名称的命名规则如下：在当前地域内，白名单名称唯一。以中文、字母或下划线（_）开头。只能包含中文、字母、数字、下划线（_）和中划线（-）。长度为 1~128 个字符。",
			Optional:    true,
			Computed:    true,
			PlanModifiers: []planmodifier.String{ /*START PLAN MODIFIERS*/
				stringplanmodifier.UseStateForUnknown(),
			}, /*END PLAN MODIFIERS*/
		}, /*END ATTRIBUTE*/
		// Property: AllowListType
		// Cloud Control resource type schema:
		//
		//	{
		//	  "description": "白名单采用的网络协议类型。取值为 IPv4（默认值）。",
		//	  "type": "string"
		//	}
		"allow_list_type": schema.StringAttribute{ /*START ATTRIBUTE*/
			Description: "白名单采用的网络协议类型。取值为 IPv4（默认值）。",
			Optional:    true,
			Computed:    true,
			PlanModifiers: []planmodifier.String{ /*START PLAN MODIFIERS*/
				stringplanmodifier.UseStateForUnknown(),
				stringplanmodifier.RequiresReplaceIfConfigured(),
			}, /*END PLAN MODIFIERS*/
		}, /*END ATTRIBUTE*/
		// Property: AssociatedInstanceNum
		// Cloud Control resource type schema:
		//
		//	{
		//	  "description": "该白名单绑定的实例数量。",
		//	  "format": "int64",
		//	  "type": "integer"
		//	}
		"associated_instance_num": schema.Int64Attribute{ /*START ATTRIBUTE*/
			Description: "该白名单绑定的实例数量。",
			Optional:    true,
			Computed:    true,
			PlanModifiers: []planmodifier.Int64{ /*START PLAN MODIFIERS*/
				int64planmodifier.UseStateForUnknown(),
			}, /*END PLAN MODIFIERS*/
		}, /*END ATTRIBUTE*/
		// Property: AssociatedInstances
		// Cloud Control resource type schema:
		//
		//	{
		//	  "description": "该白名单绑定的实例列表，包含实例 ID 和实例名称信息。",
		//	  "insertionOrder": false,
		//	  "items": {
		//	    "properties": {
		//	      "InstanceId": {
		//	        "description": "实例 ID。",
		//	        "type": "string"
		//	      },
		//	      "InstanceName": {
		//	        "description": "实例名称。",
		//	        "type": "string"
		//	      },
		//	      "VPC": {
		//	        "description": "实例所属的 VPC ID。",
		//	        "type": "string"
		//	      }
		//	    },
		//	    "type": "object"
		//	  },
		//	  "type": "array",
		//	  "uniqueItems": true
		//	}
		"associated_instances": schema.SetNestedAttribute{ /*START ATTRIBUTE*/
			NestedObject: schema.NestedAttributeObject{ /*START NESTED OBJECT*/
				Attributes: map[string]schema.Attribute{ /*START SCHEMA*/
					// Property: InstanceId
					"instance_id": schema.StringAttribute{ /*START ATTRIBUTE*/
						Description: "实例 ID。",
						Computed:    true,
					}, /*END ATTRIBUTE*/
					// Property: InstanceName
					"instance_name": schema.StringAttribute{ /*START ATTRIBUTE*/
						Description: "实例名称。",
						Computed:    true,
					}, /*END ATTRIBUTE*/
					// Property: VPC
					"vpc": schema.StringAttribute{ /*START ATTRIBUTE*/
						Description: "实例所属的 VPC ID。",
						Computed:    true,
					}, /*END ATTRIBUTE*/
				}, /*END SCHEMA*/
			}, /*END NESTED OBJECT*/
			Description: "该白名单绑定的实例列表，包含实例 ID 和实例名称信息。\n 特别提示: 在使用 SetNestedAttribute 时，必须完整定义其嵌套结构体的所有属性。若定义不完整，Terraform 在执行计划对比时可能会检测到意料之外的差异，从而触发不必要的资源更新，影响资源的稳定性与可预测性。",
			Computed:    true,
			PlanModifiers: []planmodifier.Set{ /*START PLAN MODIFIERS*/
				setplanmodifier.UseStateForUnknown(),
			}, /*END PLAN MODIFIERS*/
		}, /*END ATTRIBUTE*/
		// Property: IPAddress
		// Cloud Control resource type schema:
		//
		//	{
		//	  "description": "按 IP 地址查询白名单。支持传入多个 IP 地址，多个 IP 地址使用英文逗号（,）分隔。说明如果白名单包含了多个 IP 地址的任意子集，该白名单就会被返回。",
		//	  "type": "string"
		//	}
		"ip_address": schema.StringAttribute{ /*START ATTRIBUTE*/
			Description: "按 IP 地址查询白名单。支持传入多个 IP 地址，多个 IP 地址使用英文逗号（,）分隔。说明如果白名单包含了多个 IP 地址的任意子集，该白名单就会被返回。",
			Optional:    true,
			Computed:    true,
			PlanModifiers: []planmodifier.String{ /*START PLAN MODIFIERS*/
				stringplanmodifier.UseStateForUnknown(),
			}, /*END PLAN MODIFIERS*/
		}, /*END ATTRIBUTE*/
		// Property: ModifyMode
		// Cloud Control resource type schema:
		//
		//	{
		//	  "description": "修改白名单的方式。取值：Cover：覆盖，即使用 AllowList 字段的值覆盖原白名单。默认值。Append：追加，即在原白名单中增加 AllowList 字段包含的 IP 地址。Delete：删除，即在原白名单中删除 AllowList 字段包含的 IP 地址。至少需要保留一个 IP 地址。注意如需修改的白名单绑定有安全组，或需要在修改白名单时为白名单绑定安全组，则 ModifyMode 只能取值为 Cover。",
		//	  "type": "string"
		//	}
		"modify_mode": schema.StringAttribute{ /*START ATTRIBUTE*/
			Description: "修改白名单的方式。取值：Cover：覆盖，即使用 AllowList 字段的值覆盖原白名单。默认值。Append：追加，即在原白名单中增加 AllowList 字段包含的 IP 地址。Delete：删除，即在原白名单中删除 AllowList 字段包含的 IP 地址。至少需要保留一个 IP 地址。注意如需修改的白名单绑定有安全组，或需要在修改白名单时为白名单绑定安全组，则 ModifyMode 只能取值为 Cover。",
			Optional:    true,
			Computed:    true,
			PlanModifiers: []planmodifier.String{ /*START PLAN MODIFIERS*/
				stringplanmodifier.UseStateForUnknown(),
			}, /*END PLAN MODIFIERS*/
			// ModifyMode is a write-only property.
		}, /*END ATTRIBUTE*/
		// Property: SecurityGroupBindInfos
		// Cloud Control resource type schema:
		//
		//	{
		//	  "description": "该白名单绑定的安全组列表。",
		//	  "insertionOrder": false,
		//	  "items": {
		//	    "properties": {
		//	      "BindMode": {
		//	        "description": "关联安全组的模式。取值：IngressDirectionIp：入方向 IP。AssociateEcsIp：关联 ECSIP。",
		//	        "type": "string"
		//	      },
		//	      "IpList": {
		//	        "description": "安全组中的 IP 列表。",
		//	        "insertionOrder": false,
		//	        "items": {
		//	          "description": "安全组中的 IP。",
		//	          "type": "string"
		//	        },
		//	        "type": "array",
		//	        "uniqueItems": true
		//	      },
		//	      "SecurityGroupId": {
		//	        "description": "安全组 ID。",
		//	        "type": "string"
		//	      },
		//	      "SecurityGroupName": {
		//	        "description": "安全组名称。",
		//	        "type": "string"
		//	      }
		//	    },
		//	    "type": "object"
		//	  },
		//	  "type": "array",
		//	  "uniqueItems": true
		//	}
		"security_group_bind_infos": schema.SetNestedAttribute{ /*START ATTRIBUTE*/
			NestedObject: schema.NestedAttributeObject{ /*START NESTED OBJECT*/
				Attributes: map[string]schema.Attribute{ /*START SCHEMA*/
					// Property: BindMode
					"bind_mode": schema.StringAttribute{ /*START ATTRIBUTE*/
						Description: "关联安全组的模式。取值：IngressDirectionIp：入方向 IP。AssociateEcsIp：关联 ECSIP。",
						Optional:    true,
						Computed:    true,
						PlanModifiers: []planmodifier.String{ /*START PLAN MODIFIERS*/
							stringplanmodifier.UseStateForUnknown(),
						}, /*END PLAN MODIFIERS*/
					}, /*END ATTRIBUTE*/
					// Property: IpList
					"ip_list": schema.SetAttribute{ /*START ATTRIBUTE*/
						ElementType: types.StringType,
						Description: "安全组中的 IP 列表。",
						Optional:    true,
						Computed:    true,
						PlanModifiers: []planmodifier.Set{ /*START PLAN MODIFIERS*/
							setplanmodifier.UseStateForUnknown(),
						}, /*END PLAN MODIFIERS*/
					}, /*END ATTRIBUTE*/
					// Property: SecurityGroupId
					"security_group_id": schema.StringAttribute{ /*START ATTRIBUTE*/
						Description: "安全组 ID。",
						Optional:    true,
						Computed:    true,
						PlanModifiers: []planmodifier.String{ /*START PLAN MODIFIERS*/
							stringplanmodifier.UseStateForUnknown(),
						}, /*END PLAN MODIFIERS*/
					}, /*END ATTRIBUTE*/
					// Property: SecurityGroupName
					"security_group_name": schema.StringAttribute{ /*START ATTRIBUTE*/
						Description: "安全组名称。",
						Optional:    true,
						Computed:    true,
						PlanModifiers: []planmodifier.String{ /*START PLAN MODIFIERS*/
							stringplanmodifier.UseStateForUnknown(),
						}, /*END PLAN MODIFIERS*/
					}, /*END ATTRIBUTE*/
				}, /*END SCHEMA*/
			}, /*END NESTED OBJECT*/
			Description: "该白名单绑定的安全组列表。\n 特别提示: 在使用 SetNestedAttribute 时，必须完整定义其嵌套结构体的所有属性。若定义不完整，Terraform 在执行计划对比时可能会检测到意料之外的差异，从而触发不必要的资源更新，影响资源的稳定性与可预测性。",
			Optional:    true,
			Computed:    true,
			PlanModifiers: []planmodifier.Set{ /*START PLAN MODIFIERS*/
				setplanmodifier.UseStateForUnknown(),
			}, /*END PLAN MODIFIERS*/
		}, /*END ATTRIBUTE*/
		// Property: UpdateSecurityGroup
		// Cloud Control resource type schema:
		//
		//	{
		//	  "description": "是否更新白名单所绑定的安全组。取值：true：更新。false：不更新。默认值。",
		//	  "type": "boolean"
		//	}
		"update_security_group": schema.BoolAttribute{ /*START ATTRIBUTE*/
			Description: "是否更新白名单所绑定的安全组。取值：true：更新。false：不更新。默认值。",
			Optional:    true,
			Computed:    true,
			PlanModifiers: []planmodifier.Bool{ /*START PLAN MODIFIERS*/
				boolplanmodifier.UseStateForUnknown(),
			}, /*END PLAN MODIFIERS*/
			// UpdateSecurityGroup is a write-only property.
		}, /*END ATTRIBUTE*/
		// Property: UserAllowList
		// Cloud Control resource type schema:
		//
		//	{
		//	  "description": "安全组之外的、需要加入白名单的 IP 地址。可输入 IP 地址或 CIDR 格式的 IP 地址段。说明该字段不能与 AllowList 字段同时使用。",
		//	  "type": "string"
		//	}
		"user_allow_list": schema.StringAttribute{ /*START ATTRIBUTE*/
			Description: "安全组之外的、需要加入白名单的 IP 地址。可输入 IP 地址或 CIDR 格式的 IP 地址段。说明该字段不能与 AllowList 字段同时使用。",
			Optional:    true,
			Computed:    true,
			PlanModifiers: []planmodifier.String{ /*START PLAN MODIFIERS*/
				stringplanmodifier.UseStateForUnknown(),
			}, /*END PLAN MODIFIERS*/
		}, /*END ATTRIBUTE*/
	} /*END SCHEMA*/

	// Corresponds to Cloud Control primaryIdentifier.
	attributes["id"] = schema.StringAttribute{
		Description: "Uniquely identifies the resource.",
		Computed:    true,
		PlanModifiers: []planmodifier.String{
			stringplanmodifier.UseStateForUnknown(),
		},
	}

	schema := schema.Schema{
		Description: "白名单是数据库连接的安全防控手段，只有白名单内的 IP 地址才能访问数据库。PostgreSQL 实例在创建后，不会绑定任何白名单，默认禁止所有 IP 地址访问实例。因此无论是通过私网还是通过公网连接访问实例，都需要先为实例配置白名单，才能保证实例可连接。",
		Version:     1,
		Attributes:  attributes,
	}

	var opts generic.ResourceOptions

	opts = opts.WithCloudControlTypeName("Volcengine::RDSPostgreSQL::AllowList").WithTerraformTypeName("volcenginecc_rdspostgresql_allow_list")
	opts = opts.WithTerraformSchema(schema)
	opts = opts.WithAttributeNameMap(map[string]string{
		"allow_list":                "AllowList",
		"allow_list_category":       "AllowListCategory",
		"allow_list_desc":           "AllowListDesc",
		"allow_list_id":             "AllowListId",
		"allow_list_ip_num":         "AllowListIPNum",
		"allow_list_name":           "AllowListName",
		"allow_list_type":           "AllowListType",
		"associated_instance_num":   "AssociatedInstanceNum",
		"associated_instances":      "AssociatedInstances",
		"bind_mode":                 "BindMode",
		"instance_id":               "InstanceId",
		"instance_name":             "InstanceName",
		"ip_address":                "IPAddress",
		"ip_list":                   "IpList",
		"modify_mode":               "ModifyMode",
		"security_group_bind_infos": "SecurityGroupBindInfos",
		"security_group_id":         "SecurityGroupId",
		"security_group_name":       "SecurityGroupName",
		"update_security_group":     "UpdateSecurityGroup",
		"user_allow_list":           "UserAllowList",
		"vpc":                       "VPC",
	})

	opts = opts.WithWriteOnlyPropertyPaths([]string{
		"/properties/ModifyMode",
		"/properties/UpdateSecurityGroup",
	})

	opts = opts.WithReadOnlyPropertyPaths([]string{
		"/properties/AllowListIPNum",
		"/properties/AllowListId",
		"/properties/AssociatedInstances",
	})

	opts = opts.WithCreateOnlyPropertyPaths([]string{
		"/properties/AllowListType",
	})
	opts = opts.WithCreateTimeoutInMinutes(0).WithDeleteTimeoutInMinutes(0)

	opts = opts.WithUpdateTimeoutInMinutes(0)

	v, err := generic.NewResource(ctx, opts...)

	if err != nil {
		return nil, err
	}

	return v, nil
}
